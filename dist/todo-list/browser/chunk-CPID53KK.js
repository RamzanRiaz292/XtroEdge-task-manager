import{a as Q}from"./chunk-H47AXV6C.js";import{a as $,b as W,e as Y,p as q}from"./chunk-7VNJ2DCA.js";import{$ as u,$a as i,Da as V,Ib as G,Ja as A,Na as _,Pa as D,Vb as j,Wb as B,Z as p,_ as h,_a as g,_b as R,a as T,aa as y,ab as s,b as E,bb as m,cb as C,db as f,dc as P,eb as l,ec as F,fb as z,fc as H,gb as U,hb as L,kb as b,mb as d,nb as O,ob as M,pb as N,qb as w,rb as k,sb as S,xa as I,za as r}from"./chunk-BZLZP6YE.js";var K=["messagesContainer"],J=["messageTextarea"];function X(o,t){if(o&1&&(i(0,"span",11),d(1),s()),o&2){let e=l(2);r(),M(" ",e.formatUnreadCount(e.getTotalUnreadCount())," ")}}function ee(o,t){if(o&1){let e=C();i(0,"div",5)(1,"button",6),f("click",function(){p(e);let n=l();return h(n.toggleChatPanel())}),i(2,"span",7),u(),i(3,"svg",8),m(4,"path",9),s()(),_(5,X,2,1,"span",10),s()()}if(o&2){let e=l();b("left",e.position==="left")("right",e.position==="right"),r(),b("active",e.isOpen),r(4),g("ngIf",e.getTotalUnreadCount()>0)}}function te(o,t){if(o&1){let e=C();i(0,"div",12),f("click",function(){p(e);let n=l();return h(n.closeChat())}),s()}}function ne(o,t){if(o&1){let e=C();i(0,"button",30),f("click",function(){p(e);let n=l(2);return h(n.backToChats())}),u(),i(1,"svg",24),m(2,"path",31),s()()}}function ie(o,t){if(o&1&&(i(0,"span",36),d(1),s()),o&2){let e=l(3);r(),M(" ",e.getTotalUnreadCount()," ")}}function oe(o,t){if(o&1&&(i(0,"span",32),u(),i(1,"svg",33),m(2,"path",34),s(),d(3," Messages "),_(4,ie,2,1,"span",35),s()),o&2){let e=l(2);r(4),g("ngIf",e.getTotalUnreadCount()>0)}}function ae(o,t){if(o&1&&(i(0,"div",40),m(1,"span",41),i(2,"span",42),d(3),s()()),o&2){let e=l(3);r(),b("online",e.isUserOnline(e.selectedChat.other_user_id)),r(2),O(e.isUserOnline(e.selectedChat.other_user_id)?"Online":"Offline")}}function se(o,t){if(o&1&&(i(0,"span",37)(1,"div",38),d(2),s(),_(3,ae,4,3,"div",39),s()),o&2){let e=l(2);r(2),M(" ",e.selectedChat.type==="group"?e.selectedChat.name:e.selectedChat.other_user_name," "),r(),g("ngIf",e.selectedChat.type==="private")}}function re(o,t){if(o&1){let e=C();i(0,"button",43),f("click",function(){p(e);let n=l(2);return h(n.toggleEmployeesVisibility())}),u(),i(1,"svg",24),m(2,"path",44)(3,"circle",45)(4,"path",46)(5,"path",47),s()()}if(o&2){let e=l(2);b("active",e.showEmployees),g("title",e.showEmployees?"Hide team members":"Show team members")}}function ce(o,t){if(o&1){let e=C();i(0,"button",63),f("click",function(){p(e);let n=l(3);return h(n.showGroupCreation=!0)}),u(),i(1,"svg",64),m(2,"path",65),s()()}}function le(o,t){o&1&&(i(0,"div",66),m(1,"div",67),i(2,"span"),d(3,"Loading chats..."),s()())}function de(o,t){if(o&1&&(i(0,"span",77),d(1),s()),o&2){let e=l().$implicit,a=l(3);r(),M(" ",a.formatUnreadCount(e.unread_count)," ")}}function ge(o,t){if(o&1){let e=C();i(0,"div",68),f("click",function(){let n=p(e).$implicit,c=l(3);return h(c.handleChatSelection(n))}),i(1,"div",69),d(2),s(),i(3,"div",70)(4,"div",71)(5,"span",72),d(6),s(),i(7,"span",73),d(8),s()(),i(9,"div",74)(10,"span",75),d(11),s(),_(12,de,2,1,"span",76),s()()()}if(o&2){let e=t.$implicit,a=l(3);b("active",a.isChatSelected(e)),r(),b("group",e.type==="group")("online",e.type==="private"&&a.isUserOnline(e.other_user_id)),r(),M(" ",e.type==="group"?"\u{1F465}":e.other_user_name?e.other_user_name.charAt(0).toUpperCase():"?"," "),r(4),M(" ",e.type==="group"?e.name||"Group Chat":e.other_user_name||"Unknown User"," "),r(2),O(a.formatTime(e.last_message_time)),r(3),O(e.last_message||"No messages yet"),r(),g("ngIf",e.unread_count>0)}}function pe(o,t){o&1&&(i(0,"div",78)(1,"div",79),d(2,"\u{1F4AC}"),s(),i(3,"p"),d(4,"No conversations yet"),s(),i(5,"small"),d(6,"Start a new chat to begin messaging"),s()())}function he(o,t){if(o&1&&(i(0,"div",48)(1,"div",49)(2,"div",50)(3,"div",51)(4,"div",52),u(),i(5,"svg",53),m(6,"circle",54)(7,"path",55),s(),y(),m(8,"input",56),s(),i(9,"div",57),_(10,ce,3,0,"button",58),s()(),i(11,"div",59),_(12,le,4,0,"div",60)(13,ge,13,11,"div",61)(14,pe,7,0,"div",62),s()()()()),o&2){let e=l(2);r(10),g("ngIf",e.isManager()),r(2),g("ngIf",e.isLoadingChats),r(),g("ngForOf",e.chats),r(),g("ngIf",!e.isLoadingChats&&e.chats.length===0)}}function me(o,t){o&1&&(i(0,"div",94),m(1,"div",67),i(2,"span"),d(3,"Loading messages..."),s()())}function _e(o,t){if(o&1&&(i(0,"div",103),d(1),s()),o&2){let e=l().$implicit;r(),M(" ",e.sender_name," ")}}function fe(o,t){o&1&&(u(),i(0,"svg",106),m(1,"path",107),s())}function ue(o,t){o&1&&(u(),i(0,"svg",106),m(1,"path",108),s())}function Ce(o,t){if(o&1&&(i(0,"span",104),_(1,fe,2,0,"svg",105)(2,ue,2,0,"svg",105),s()),o&2){let e=l().$implicit;r(),g("ngIf",e.is_read),r(),g("ngIf",!e.is_read)}}function xe(o,t){if(o&1&&(i(0,"div",95)(1,"div",96),_(2,_e,2,1,"div",97),i(3,"div",98)(4,"p",99),d(5),s(),i(6,"div",100)(7,"span",101),d(8),s(),_(9,Ce,3,2,"span",102),s()()()()),o&2){let e=t.$implicit,a=l(3);b("sent",e.sender_id===(a.currentUser==null?null:a.currentUser.id))("received",e.sender_id!==(a.currentUser==null?null:a.currentUser.id)),r(2),g("ngIf",e.sender_id!==(a.currentUser==null?null:a.currentUser.id)&&(a.selectedChat==null?null:a.selectedChat.type)==="group"),r(3),O(e.content),r(3),O(a.formatTime(e.created_at)),r(),g("ngIf",e.sender_id===(a.currentUser==null?null:a.currentUser.id))}}function be(o,t){if(o&1&&(i(0,"div",109)(1,"div",110),m(2,"div",111)(3,"div",111)(4,"div",111),s(),i(5,"span",112),d(6),s()()),o&2){let e=l(3);r(6),N(" ",e.typingUsers.join(", ")," ",e.typingUsers.length===1?"is":"are"," typing... ")}}function Me(o,t){o&1&&(i(0,"div",113)(1,"div",114),d(2,"\u{1F4AC}"),s(),i(3,"p"),d(4,"No messages yet"),s(),i(5,"small"),d(6,"Send a message to start the conversation"),s()())}function Oe(o,t){if(o&1){let e=C();i(0,"div",80)(1,"div",81,0),_(3,me,4,0,"div",82)(4,xe,10,8,"div",83)(5,be,7,2,"div",84)(6,Me,7,0,"div",85),s(),i(7,"div",86)(8,"div",87)(9,"button",88),u(),i(10,"svg",24),m(11,"path",89),s()(),y(),i(12,"textarea",90,1),S("ngModelChange",function(n){p(e);let c=l(2);return k(c.newMessage,n)||(c.newMessage=n),h(n)}),f("keydown",function(n){p(e);let c=l(2);return h(c.onKeyPress(n))})("input",function(){p(e);let n=l(2);return h(n.onInputChange())}),s(),i(14,"button",91),f("click",function(){p(e);let n=l(2);return h(n.sendMessage())}),u(),i(15,"svg",92),m(16,"path",93),s()()()()()}if(o&2){let e=l(2);r(3),g("ngIf",e.isLoadingMessages),r(),g("ngForOf",e.messages),r(),g("ngIf",e.isTyping),r(),g("ngIf",!e.isLoadingMessages&&e.messages.length===0),r(6),w("ngModel",e.newMessage),r(2),g("disabled",!e.newMessage.trim())}}function ye(o,t){o&1&&(i(0,"div",130),m(1,"div",67),i(2,"span"),d(3,"Loading team members..."),s()())}function Pe(o,t){if(o&1){let e=C();i(0,"button",131),f("click",function(){p(e);let n=l(3);return h(n.clearEmployeeSearch())}),u(),i(1,"svg",132),m(2,"path",25),s()()}}function ve(o,t){o&1&&(i(0,"div",137)(1,"p"),d(2,"No team members found"),s(),i(3,"small"),d(4,"Try a different search term"),s()())}function we(o,t){if(o&1&&(i(0,"span",150),d(1),s()),o&2){let e=l().$implicit;r(),M("\u2022 ",e.department)}}function ke(o,t){if(o&1){let e=C();i(0,"div",138),f("click",function(){let n=p(e).$implicit,c=l(4);return h(c.startPrivateChat(n))}),i(1,"div",139),d(2),s(),i(3,"div",140)(4,"span",141),d(5),s(),i(6,"span",142)(7,"span",143),d(8),s(),_(9,we,2,1,"span",144),s(),i(10,"div",145),m(11,"span",41),i(12,"span",42),d(13),s()()(),i(14,"div",146)(15,"button",147),u(),i(16,"svg",148),m(17,"path",149),s()()()()}if(o&2){let e=t.$implicit;r(),b("online",e.isOnline),r(),M(" ",e.name.charAt(0).toUpperCase()," "),r(3),O(e.name),r(3),O(e.role),r(),g("ngIf",e.department),r(2),b("online",e.isOnline),r(2),O(e.isOnline?"Online":"Offline")}}function Se(o,t){if(o&1&&(i(0,"div",133)(1,"div",134),d(2),s(),_(3,ve,5,0,"div",135)(4,ke,18,9,"div",136),s()),o&2){let e=l(3);r(2),N(" Showing ",e.filteredEmployees.length," of ",e.employees.length," team members "),r(),g("ngIf",e.filteredEmployees.length===0),r(),g("ngForOf",e.filteredEmployees)}}function Te(o,t){if(o&1){let e=C();i(0,"button",151),f("click",function(){p(e);let n=l(3);return n.showGroupCreation=!0,h(n.showEmployees=!1)}),d(1," Create Group "),s()}}function Ee(o,t){if(o&1){let e=C();i(0,"div",115),f("click",function(){p(e);let n=l(2);return h(n.toggleEmployeesVisibility())}),i(1,"div",116),f("click",function(n){return p(e),h(n.stopPropagation())}),i(2,"div",117)(3,"h3"),u(),i(4,"svg",118),m(5,"path",44)(6,"circle",45)(7,"path",46)(8,"path",47),s(),d(9," Team Members "),s(),y(),i(10,"button",119),f("click",function(){p(e);let n=l(2);return h(n.toggleEmployeesVisibility())}),u(),i(11,"svg",24),m(12,"path",25),s()()(),y(),i(13,"div",120),_(14,ye,4,0,"div",121),i(15,"div",122),u(),i(16,"svg",123),m(17,"circle",54)(18,"path",55),s(),y(),i(19,"input",124),S("ngModelChange",function(n){p(e);let c=l(2);return k(c.employeeSearch,n)||(c.employeeSearch=n),h(n)}),f("input",function(){p(e);let n=l(2);return h(n.onEmployeeSearchChange())}),s(),_(20,Pe,3,0,"button",125),s(),_(21,Se,5,4,"div",126),s(),i(22,"div",127)(23,"button",128),f("click",function(){p(e);let n=l(2);return h(n.toggleEmployeesVisibility())}),d(24,"Close"),s(),_(25,Te,2,0,"button",129),s()()()}if(o&2){let e=l(2);r(14),g("ngIf",e.isLoadingEmployees),r(5),w("ngModel",e.employeeSearch),r(),g("ngIf",e.employeeSearch),r(),g("ngIf",!e.isLoadingEmployees),r(4),g("ngIf",e.isManager())}}function Ie(o,t){o&1&&(i(0,"small",166),d(1,"Group name is required"),s())}function Ve(o,t){if(o&1&&(i(0,"span",167),d(1),s()),o&2){let e=l(3);r(),M(" ",e.selectedEmployees.length," selected ")}}function ze(o,t){o&1&&(i(0,"div",130),m(1,"div",168),i(2,"span"),d(3,"Loading team members..."),s()())}function Ue(o,t){o&1&&(i(0,"div",137)(1,"p"),d(2,"No team members available"),s(),i(3,"small"),d(4,"Check your backend API endpoint"),s()())}function Le(o,t){if(o&1&&(i(0,"span",150),d(1),s()),o&2){let e=l().$implicit;r(),M("\u2022 ",e.department)}}function Ne(o,t){if(o&1){let e=C();i(0,"div",173),f("click",function(){let n=p(e).$implicit,c=l(4);return h(c.toggleEmployeeSelection(n.id))}),i(1,"div",139),d(2),s(),i(3,"div",140)(4,"span",141),d(5),s(),i(6,"span",142)(7,"span",143),d(8),s(),_(9,Le,2,1,"span",144),s()(),i(10,"div",174),u(),i(11,"svg",175),m(12,"path",176),s()()()}if(o&2){let e=t.$implicit,a=l(4);b("selected",a.selectedEmployees.includes(e.id)),r(),b("online",e.isOnline),r(),M(" ",e.name.charAt(0).toUpperCase()," "),r(3),O(e.name),r(3),O(e.role),r(),g("ngIf",e.department),r(),b("selected",a.selectedEmployees.includes(e.id))}}function Ae(o,t){if(o&1){let e=C();i(0,"div",169)(1,"div",122),u(),i(2,"svg",123),m(3,"circle",54)(4,"path",55),s(),y(),i(5,"input",170),S("ngModelChange",function(n){p(e);let c=l(3);return k(c.employeeSearch,n)||(c.employeeSearch=n),h(n)}),s()(),i(6,"div",171),_(7,Ue,5,0,"div",135)(8,Ne,13,10,"div",172),s()()}if(o&2){let e=l(3);r(5),w("ngModel",e.employeeSearch),r(2),g("ngIf",e.filteredEmployees.length===0),r(),g("ngForOf",e.filteredEmployees)}}function De(o,t){if(o&1){let e=C();i(0,"div",152),f("click",function(){p(e);let n=l(2);return h(n.showGroupCreation=!1)}),i(1,"div",153),f("click",function(n){return p(e),h(n.stopPropagation())}),i(2,"div",117)(3,"h3"),u(),i(4,"svg",118),m(5,"path",154)(6,"path",155)(7,"path",156)(8,"path",157),s(),d(9," Create Group Chat "),s(),y(),i(10,"button",119),f("click",function(){p(e);let n=l(2);return h(n.showGroupCreation=!1)}),u(),i(11,"svg",24),m(12,"path",25),s()()(),y(),i(13,"div",158)(14,"div",159)(15,"label"),d(16,"Group Name *"),s(),i(17,"input",160),S("ngModelChange",function(n){p(e);let c=l(2);return k(c.groupName,n)||(c.groupName=n),h(n)}),s(),_(18,Ie,2,0,"small",161),s(),i(19,"div",159)(20,"div",162)(21,"label"),d(22,"Select Team Members *"),s(),_(23,Ve,2,1,"span",163),s(),_(24,ze,4,0,"div",121)(25,Ae,9,3,"div",164),s()(),i(26,"div",127)(27,"button",128),f("click",function(){p(e);let n=l(2);return h(n.showGroupCreation=!1)}),d(28,"Cancel"),s(),i(29,"button",165),f("click",function(){p(e);let n=l(2);return h(n.createGroupChat())}),d(30," Create Group "),s()()()()}if(o&2){let e=l(2);r(17),w("ngModel",e.groupName),r(),g("ngIf",!e.groupName.trim()),r(5),g("ngIf",e.selectedEmployees.length>0),r(),g("ngIf",e.isLoadingEmployees),r(),g("ngIf",!e.isLoadingEmployees),r(4),g("disabled",!e.groupName.trim()||e.selectedEmployees.length===0)}}function Ge(o,t){if(o&1){let e=C();i(0,"div",13)(1,"div",14)(2,"div",15),_(3,ne,3,0,"button",16),i(4,"div",17)(5,"h3",18),_(6,oe,5,1,"span",19)(7,se,4,2,"span",20),s()(),i(8,"div",21),_(9,re,6,3,"button",22),i(10,"button",23),f("click",function(){p(e);let n=l();return h(n.closeChat())}),u(),i(11,"svg",24),m(12,"path",25),s()()()()(),_(13,he,15,4,"div",26)(14,Oe,17,6,"div",27)(15,Ee,26,5,"div",28)(16,De,31,6,"div",29),s()}if(o&2){let e=l();b("open",e.isOpen)("left-side",e.position==="left")("right-side",e.position==="right"),r(3),g("ngIf",e.selectedChat),r(3),g("ngIf",!e.selectedChat),r(),g("ngIf",e.selectedChat),r(2),g("ngIf",!e.selectedChat&&e.isManager()),r(4),g("ngIf",!e.selectedChat),r(),g("ngIf",e.selectedChat),r(),g("ngIf",e.showEmployees&&!e.selectedChat),r(),g("ngIf",e.showGroupCreation)}}var Z=class o{constructor(t,e){this.http=t;this.cdr=e;if(!this.currentUser){let a=localStorage.getItem("user");this.currentUser=a?JSON.parse(a):null}}position="right";currentUser;toggleChat=new D;messagesContainer;messageTextarea;isOpen=!1;showEmployees=!1;showGroupCreation=!1;chats=[];selectedChat=null;messages=[];employees=[];newMessage="";groupName="";selectedEmployees=[];employeeSearch="";isTyping=!1;typingUsers=[];onlineUsers=new Set;isLoadingChats=!1;isLoadingMessages=!1;isLoadingEmployees=!1;socket=null;refreshInterval;API_URL=this.getApiUrl();getApiUrl(){let t=window.location.href;return t.includes("localhost")||t.includes("127.0.0.1")?"http://localhost:3000/api":"https://xtro-edge-task-manager-backend.vercel.app/api"}sentMessageIds=new Set;lastMessageTime=0;messageDebounceTimeout;loadingTimeouts=[];typingTimeout;ngOnInit(){console.log("Chat Component Initialized"),this.loadEmployees(),this.initializeWebSocket(),this.startAutoRefresh(),this.requestNotificationPermission(),setTimeout(()=>{this.isOpen&&this.messageTextarea&&this.messageTextarea.nativeElement.focus()},500)}ngOnDestroy(){this.cleanup()}get filteredEmployees(){if(!this.employeeSearch.trim())return this.employees;let t=this.employeeSearch.toLowerCase();return this.employees.filter(e=>e.name.toLowerCase().includes(t)||e.email.toLowerCase().includes(t)||e.role.toLowerCase().includes(t)||e.department&&e.department.toLowerCase().includes(t))}cleanup(){this.loadingTimeouts.forEach(t=>clearTimeout(t)),this.loadingTimeouts=[],this.refreshInterval&&clearInterval(this.refreshInterval),this.messageDebounceTimeout&&clearTimeout(this.messageDebounceTimeout),this.typingTimeout&&clearTimeout(this.typingTimeout),this.socket&&this.socket.disconnect()}requestNotificationPermission(){if(!("Notification"in window)){console.log("This browser does not support notifications.");return}Notification.permission==="default"&&Notification.requestPermission().then(t=>{console.log("Notification permission:",t)})}initializeWebSocket(){try{this.socket=Q(this.API_URL.replace("/api",""),{transports:["websocket","polling"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,auth:{token:localStorage.getItem("token")||""}}),this.socket.on("connect",()=>{console.log("Connected to WebSocket server"),this.currentUser&&this.socket?.emit("authenticate",{userId:this.currentUser.id,name:this.currentUser.name,role:this.currentUser.role})}),this.socket.on("new_message",t=>{this.handleNewMessage(t)}),this.socket.on("user_typing",t=>{this.handleTypingIndicator(t)}),this.socket.on("user_online_status",t=>{this.handleOnlineStatus(t)}),this.socket.on("messages_read",t=>{this.handleMessagesRead(t)}),this.socket.on("disconnect",()=>{console.log("Disconnected from WebSocket server")}),this.socket.on("connect_error",t=>{console.error("WebSocket connection error:",t)})}catch(t){console.error("Failed to initialize WebSocket:",t)}}handleNewMessage(t){let e=this.messages.some(n=>n.id===t.id),a=t.sender_id===this.currentUser?.id;e||(this.selectedChat&&this.selectedChat.id===t.chat_id&&(this.messages.push(t),this.sentMessageIds.add(t.id),this.scrollToBottom(),a||(this.playNotificationSound(),this.markMessagesAsRead(this.selectedChat.id))),this.updateChatList(t),!a&&!this.isOpen?this.showDesktopNotification(t):!a&&this.isOpen&&this.selectedChat?.id!==t.chat_id&&this.showDesktopNotification(t)),this.cdr.detectChanges()}handleTypingIndicator(t){if(this.selectedChat&&this.selectedChat.id===t.chatId&&t.userId!==this.currentUser?.id){if(t.isTyping&&!this.typingUsers.includes(t.userName)?this.typingUsers.push(t.userName):t.isTyping||(this.typingUsers=this.typingUsers.filter(e=>e!==t.userName)),this.isTyping=this.typingUsers.length>0,this.isTyping){let e=setTimeout(()=>{this.isTyping=!1,this.typingUsers=[],this.cdr.detectChanges()},3e3);this.loadingTimeouts.push(e)}this.cdr.detectChanges()}}handleOnlineStatus(t){t.isOnline?this.onlineUsers.add(t.userId):this.onlineUsers.delete(t.userId),this.employees=this.employees.map(e=>e.user_id===t.userId||e.id===t.userId?E(T({},e),{isOnline:t.isOnline}):e),this.cdr.detectChanges()}handleMessagesRead(t){this.selectedChat&&this.selectedChat.id===t.chatId&&(this.messages.forEach(e=>{e.sender_id!==this.currentUser?.id&&(e.is_read=!0)}),this.cdr.detectChanges())}playNotificationSound(){try{new Audio("assets/notification.mp3").play().catch(e=>{console.log("Audio play failed:",e),this.playFallbackSound()})}catch{this.playFallbackSound()}}playFallbackSound(){try{let t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),a=t.createGain();e.connect(a),a.connect(t.destination),e.frequency.value=800,e.type="sine",a.gain.setValueAtTime(0,t.currentTime),a.gain.linearRampToValueAtTime(.1,t.currentTime+.01),a.gain.exponentialRampToValueAtTime(.001,t.currentTime+.5),e.start(),setTimeout(()=>e.stop(),500)}catch{console.log("Audio not supported")}}showDesktopNotification(t){if("Notification"in window)if(Notification.permission==="granted"){let e={body:t.content.length>50?t.content.substring(0,50)+"...":t.content,icon:"/assets/chat-icon.png",tag:`chat-${t.chat_id}-${t.id}`,requireInteraction:!0,silent:!1};"vibrate"in navigator&&navigator.vibrate&&navigator.vibrate([200,100,200]);let a=new Notification(`New message from ${t.sender_name}`,e);a.onclick=()=>{if(window.focus(),this.isOpen=!0,this.selectedChat?.id!==t.chat_id){let n=this.chats.find(c=>c.id===t.chat_id);n&&this.selectChat(n)}a.close()},a.onclose=()=>{console.log("Notification closed")},setTimeout(()=>a.close(),1e4)}else Notification.permission==="default"&&Notification.requestPermission().then(e=>{e==="granted"&&this.showDesktopNotification(t)})}toggleChatPanel(){this.isOpen=!this.isOpen,this.isOpen?(this.loadChats(),setTimeout(()=>{this.messageTextarea&&this.messageTextarea.nativeElement.focus(),this.selectedChat&&this.markMessagesAsRead(this.selectedChat.id)},300)):(this.selectedChat=null,this.messages=[],this.isTyping=!1,this.typingUsers=[]),this.toggleChat.emit(),this.cdr.detectChanges()}closeChat(){this.isOpen=!1,this.selectedChat=null,this.messages=[],this.isTyping=!1,this.typingUsers=[],this.showEmployees=!1,this.toggleChat.emit(),this.cdr.detectChanges()}toggleEmployeesVisibility(){this.showEmployees=!this.showEmployees,console.log("Employees visibility toggled:",this.showEmployees),this.showEmployees&&this.employees.length===0&&!this.isLoadingEmployees&&this.loadEmployees(),this.cdr.detectChanges()}loadChats(){if(this.isLoadingChats)return;this.isLoadingChats=!0;let t=localStorage.getItem("token");if(!t){console.error("No authentication token found"),this.isLoadingChats=!1,this.cdr.detectChanges();return}let e=setTimeout(()=>{this.isLoadingChats=!1,this.cdr.detectChanges()},1e4);this.loadingTimeouts.push(e);let a=new P({Authorization:`Bearer ${t}`,"Content-Type":"application/json"});this.http.get(`${this.API_URL}/chats`,{headers:a}).subscribe({next:n=>{clearTimeout(e),this.chats=Array.isArray(n)?n:[],this.removeDuplicateChats(),this.sortChatsByRecent(),this.isLoadingChats=!1,this.cdr.detectChanges()},error:n=>{clearTimeout(e),console.error("Failed to load chats:",n),this.showError("Failed to load chats. Please try again."),this.isLoadingChats=!1,this.chats=[],this.cdr.detectChanges()}})}removeDuplicateChats(){let t=new Map;this.chats.forEach(e=>{t.has(e.id)||t.set(e.id,e)}),this.chats=Array.from(t.values())}sortChatsByRecent(){this.chats.sort((t,e)=>{let a=t.last_message_time?new Date(t.last_message_time).getTime():0;return(e.last_message_time?new Date(e.last_message_time).getTime():0)-a})}selectChat(t){this.selectedChat=t,this.sentMessageIds.clear(),this.loadMessages(t.id),this.markMessagesAsRead(t.id),this.socket?.emit("join_chat",t.id),setTimeout(()=>{this.messageTextarea&&this.messageTextarea.nativeElement.focus()},100),this.cdr.detectChanges()}loadMessages(t){this.isLoadingMessages=!0;let e=localStorage.getItem("token");if(!e){console.error("No authentication token found"),this.isLoadingMessages=!1,this.cdr.detectChanges();return}let a=setTimeout(()=>{this.isLoadingMessages=!1,this.cdr.detectChanges()},1e4);this.loadingTimeouts.push(a);let n=new P({Authorization:`Bearer ${e}`,"Content-Type":"application/json"});this.http.get(`${this.API_URL}/chats/${t}/messages`,{headers:n}).subscribe({next:c=>{clearTimeout(a),this.messages=c,this.isLoadingMessages=!1,this.sentMessageIds.clear(),c.forEach(x=>this.sentMessageIds.add(x.id)),this.scrollToBottom(),this.cdr.detectChanges()},error:c=>{clearTimeout(a),console.error("Failed to load messages:",c),this.showError("Failed to load messages. Please try again."),this.isLoadingMessages=!1,this.cdr.detectChanges()}})}sendMessage(){if(!this.newMessage.trim()||!this.selectedChat)return;let t=Date.now();if(t-this.lastMessageTime<1e3){console.log("Message sending too quickly, ignoring");return}this.lastMessageTime=t;let e=this.newMessage.trim();this.newMessage="",this.autoResizeTextarea();let a=localStorage.getItem("token");if(!a){this.showError("Authentication required. Please login again.");return}let n=new P({Authorization:`Bearer ${a}`,"Content-Type":"application/json"});this.http.post(`${this.API_URL}/chats/${this.selectedChat.id}/messages`,{content:e,message_type:"text"},{headers:n}).subscribe({next:c=>{this.messages.some(v=>v.id===c.id)||(this.messages.push(c),this.sentMessageIds.add(c.id),this.scrollToBottom()),this.stopTyping(),this.updateChatList(c),this.cdr.detectChanges()},error:c=>{console.error("Failed to send message:",c);let x=c.error?.message||"Failed to send message. Please try again.";this.showError(x),this.newMessage=e,this.cdr.detectChanges()}})}loadEmployees(){if(!this.isManager()){console.log("Not a manager, skipping employee load");return}this.isLoadingEmployees=!0;let t=localStorage.getItem("token");if(!t){console.error("No authentication token found for loading employees"),this.isLoadingEmployees=!1,this.cdr.detectChanges();return}let e=new P({Authorization:`Bearer ${t}`,"Content-Type":"application/json"});this.http.get(`${this.API_URL}/employees`,{headers:e}).subscribe({next:a=>{this.employees=a.filter(n=>n.id!==this.currentUser?.id&&n.user_id!==this.currentUser?.id).map(n=>E(T({},n),{isOnline:this.onlineUsers.has(n.user_id||n.id)})),this.isLoadingEmployees=!1,this.cdr.detectChanges()},error:a=>{console.error("Failed to load employees:",a),this.isLoadingEmployees=!1,this.cdr.detectChanges()}})}startPrivateChat(t){let e=localStorage.getItem("token");if(!e){this.showError("Authentication required. Please login again.");return}let a=new P({Authorization:`Bearer ${e}`,"Content-Type":"application/json"});this.http.post(`${this.API_URL}/chats/private`,{other_user_id:t.user_id||t.id},{headers:a}).subscribe({next:n=>{this.showSuccess("Chat started successfully"),this.loadChats(),this.showEmployees=!1;let c=setTimeout(()=>{let x=this.chats.find(v=>v.id===n.chat_id);x?this.selectChat(x):n.chat&&this.selectChat(n.chat),this.cdr.detectChanges()},500);this.loadingTimeouts.push(c)},error:n=>{console.error("Failed to start private chat:",n);let c=n.error?.message||"Failed to start chat. Please try again.";this.showError(c)}})}createGroupChat(){if(!this.groupName.trim()||this.selectedEmployees.length===0){this.showError("Please enter group name and select at least one employee");return}let t=localStorage.getItem("token");if(!t){this.showError("Authentication required. Please login again.");return}let e=new P({Authorization:`Bearer ${t}`,"Content-Type":"application/json"}),a=this.selectedEmployees.map(n=>this.employees.find(x=>x.id===n)?.user_id||n);this.http.post(`${this.API_URL}/chats/group`,{name:this.groupName.trim(),participant_ids:a},{headers:e}).subscribe({next:n=>{this.showSuccess(n.message),this.showGroupCreation=!1,this.groupName="",this.selectedEmployees=[],this.loadChats(),this.showEmployees=!1;let c=setTimeout(()=>{let x=this.chats.find(v=>v.name===this.groupName.trim());x?this.selectChat(x):n.chat&&this.selectChat(n.chat)},1e3);this.loadingTimeouts.push(c),this.cdr.detectChanges()},error:n=>{console.error("Failed to create group chat:",n);let c=n.error?.message||"Failed to create group chat. Please try again.";this.showError(c)}})}toggleEmployeeSelection(t){let e=this.selectedEmployees.indexOf(t);e>-1?this.selectedEmployees.splice(e,1):this.selectedEmployees.push(t),this.cdr.detectChanges()}onTyping(){this.selectedChat&&(this.typingTimeout&&clearTimeout(this.typingTimeout),this.socket?.emit("typing",{chatId:this.selectedChat.id,isTyping:!0,userName:this.currentUser?.name,userId:this.currentUser?.id}),this.typingTimeout=setTimeout(()=>{this.stopTyping()},2e3))}stopTyping(){this.selectedChat&&this.socket?.emit("typing",{chatId:this.selectedChat.id,isTyping:!1,userName:this.currentUser?.name,userId:this.currentUser?.id}),this.typingTimeout&&(clearTimeout(this.typingTimeout),this.typingTimeout=null)}onInputChange(){this.onTyping(),this.autoResizeTextarea()}markMessagesAsRead(t){let e=localStorage.getItem("token");if(!e)return;let a=new P({Authorization:`Bearer ${e}`,"Content-Type":"application/json"});this.http.put(`${this.API_URL}/chats/${t}/mark-read`,{},{headers:a}).subscribe({next:()=>{let n=this.chats.findIndex(c=>c.id===t);n>-1&&(this.chats[n].unread_count=0),this.messages.forEach(c=>{c.sender_id!==this.currentUser?.id&&(c.is_read=!0)}),this.cdr.detectChanges()},error:n=>{console.error("Failed to mark messages as read:",n)}})}updateChatList(t){let e=this.chats.findIndex(a=>a.id===t.chat_id);if(e>-1){let a=this.chats[e];a.last_message=t.content.length>30?t.content.substring(0,30)+"...":t.content,a.last_message_time=t.created_at;let n=t.sender_id===this.currentUser?.id,c=this.selectedChat?.id===t.chat_id;!n&&!c?a.unread_count+=1:c&&(a.unread_count=0),this.chats.splice(e,1),this.chats.unshift(a)}else this.loadChats();this.cdr.detectChanges()}backToChats(){this.selectedChat&&(this.socket?.emit("leave_chat",this.selectedChat.id),this.stopTyping()),this.selectedChat=null,this.messages=[],this.isTyping=!1,this.typingUsers=[],this.loadChats(),this.cdr.detectChanges()}startAutoRefresh(){this.refreshInterval=setInterval(()=>{this.isOpen&&!this.isLoadingChats&&!this.isLoadingMessages&&(this.selectedChat?this.loadMessages(this.selectedChat.id):this.loadChats()),this.isManager()&&this.showEmployees&&this.updateOnlineStatus()},3e4)}updateOnlineStatus(){this.employees=this.employees.map(t=>E(T({},t),{isOnline:this.onlineUsers.has(t.user_id||t.id)})),this.cdr.detectChanges()}scrollToBottom(){setTimeout(()=>{if(this.messagesContainer&&this.messagesContainer.nativeElement){let t=this.messagesContainer.nativeElement;t.scrollTop=t.scrollHeight}},100)}formatTime(t){if(!t)return"";try{let e=new Date(t);if(isNaN(e.getTime()))return"";let n=Math.floor((new Date().getTime()-e.getTime())/(1e3*60)),c=Math.floor(n/60),x=Math.floor(c/24);return n<1?"Just now":n<60?`${n}m ago`:c<24?e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}):x===1?"Yesterday":x<7?e.toLocaleDateString("en-US",{weekday:"short"}):e.toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}isManager(){return this.currentUser?.role==="manager"||this.currentUser?.role==="admin"}isUserOnline(t){return this.onlineUsers.has(t)}onKeyPress(t){t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),this.sendMessage())}isChatSelected(t){return this.selectedChat!==null&&this.selectedChat.id===t.id}showSuccess(t){console.log("Success:",t)}showError(t){console.error("Error:",t)}autoResizeTextarea(){setTimeout(()=>{if(this.messageTextarea){let t=this.messageTextarea.nativeElement;t.style.height="auto",t.style.height=Math.min(t.scrollHeight,120)+"px"}},0)}onWindowFocus(){this.selectedChat&&this.markMessagesAsRead(this.selectedChat.id)}shouldShowChat(){return!!this.currentUser}handleChatSelection(t){this.isChatSelected(t)?this.backToChats():this.selectChat(t)}getTotalUnreadCount(){return this.chats.reduce((e,a)=>{let n=Number(a.unread_count)||0;return e+n},0)}formatUnreadCount(t){return t<=0?"":t>99?"99+":t.toString()}onEmployeeSearchChange(){this.messageDebounceTimeout&&clearTimeout(this.messageDebounceTimeout),this.messageDebounceTimeout=setTimeout(()=>{this.cdr.detectChanges()},300)}clearEmployeeSearch(){this.employeeSearch="",this.cdr.detectChanges()}onResize(){window.innerWidth<768&&this.isOpen&&this.showEmployees&&(this.showEmployees=!1)}static \u0275fac=function(e){return new(e||o)(V(F),V(G))};static \u0275cmp=A({type:o,selectors:[["app-chat"]],viewQuery:function(e,a){if(e&1&&(z(K,5),z(J,5)),e&2){let n;U(n=L())&&(a.messagesContainer=n.first),U(n=L())&&(a.messageTextarea=n.first)}},hostBindings:function(e,a){e&1&&f("focus",function(){return a.onWindowFocus()},I)("resize",function(){return a.onResize()},I)},inputs:{position:"position",currentUser:"currentUser"},outputs:{toggleChat:"toggleChat"},decls:3,vars:3,consts:[["messagesContainer",""],["messageTextarea",""],["class","chat-floating-button",3,"left","right",4,"ngIf"],["class","chat-overlay",3,"click",4,"ngIf"],["class","chat-panel",3,"open","left-side","right-side",4,"ngIf"],[1,"chat-floating-button"],[1,"chat-toggle-btn",3,"click"],[1,"chat-icon"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M20 2H4C2.9 2 2 2.9 2 4V22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2Z","fill","white"],["class","unread-indicator",4,"ngIf"],[1,"unread-indicator"],[1,"chat-overlay",3,"click"],[1,"chat-panel"],[1,"chat-header"],[1,"chat-header-content"],["class","btn-back",3,"click",4,"ngIf"],[1,"header-title"],[1,"chat-title"],["class","title-text",4,"ngIf"],["class","selected-chat-info",4,"ngIf"],[1,"header-actions"],["class","btn-toggle-employees",3,"active","title","click",4,"ngIf"],["title","Close chat",1,"btn-close",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M18 6L6 18M6 6l12 12"],["class","chats-view",4,"ngIf"],["class","messages-view",4,"ngIf"],["class","modal-overlay employees-overlay",3,"click",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"btn-back",3,"click"],["d","M15 18l-6-6 6-6"],[1,"title-text"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"title-icon"],["d","M20 2H4C2.9 2 2 2.9 2 4V22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2Z"],["class","total-unread-badge",4,"ngIf"],[1,"total-unread-badge"],[1,"selected-chat-info"],[1,"selected-chat-name"],["class","user-status",4,"ngIf"],[1,"user-status"],[1,"status-dot"],[1,"status-text"],[1,"btn-toggle-employees",3,"click","title"],["d","M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"],["cx","9","cy","7","r","4"],["d","M23 21v-2a4 4 0 0 0-3-3.87"],["d","M16 3.13a4 4 0 0 1 0 7.75"],[1,"chats-view"],[1,"main-chat-container"],[1,"chats-list-section"],[1,"chats-toolbar"],[1,"search-container"],["width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"search-icon"],["cx","11","cy","11","r","8"],["d","M21 21l-4.35-4.35"],["type","text","placeholder","Search chats...",1,"search-input"],[1,"toolbar-actions"],["class","btn-new-group","title","New Group",3,"click",4,"ngIf"],[1,"chats-list-container"],["class","loading-chats",4,"ngIf"],["class","chat-item",3,"active","click",4,"ngFor","ngForOf"],["class","no-chats",4,"ngIf"],["title","New Group",1,"btn-new-group",3,"click"],["width","18","height","18","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M12 5v14M5 12h14"],[1,"loading-chats"],[1,"loading-spinner"],[1,"chat-item",3,"click"],[1,"chat-avatar"],[1,"chat-info"],[1,"chat-main-info"],[1,"chat-name"],[1,"chat-time"],[1,"chat-preview"],[1,"last-message"],["class","unread-count",4,"ngIf"],[1,"unread-count"],[1,"no-chats"],[1,"no-chats-icon"],[1,"messages-view"],[1,"messages-container"],["class","loading-messages",4,"ngIf"],["class","message",3,"sent","received",4,"ngFor","ngForOf"],["class","typing-indicator",4,"ngIf"],["class","no-messages",4,"ngIf"],[1,"message-input-container"],[1,"message-input-wrapper"],["title","Attach file",1,"btn-attach"],["d","M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"],["placeholder","Type your message...","rows","1",1,"message-input",3,"ngModelChange","keydown","input","ngModel"],["title","Send message",1,"btn-send",3,"click","disabled"],["width","20","height","20","viewBox","0 0 24 24","fill","currentColor"],["d","M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"],[1,"loading-messages"],[1,"message"],[1,"message-content"],["class","message-sender",4,"ngIf"],[1,"message-bubble"],[1,"message-text"],[1,"message-footer"],[1,"message-time"],["class","read-status",4,"ngIf"],[1,"message-sender"],[1,"read-status"],["width","12","height","12","viewBox","0 0 24 24","fill","currentColor",4,"ngIf"],["width","12","height","12","viewBox","0 0 24 24","fill","currentColor"],["d","M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"],["d","M21.99 8c0-.72-.37-1.35-.94-1.7L12 1 2.95 6.3C2.38 6.65 2 7.28 2 8v10c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2l-.01-10zM12 13L3.74 7.84 12 3l8.26 4.84L12 13z"],[1,"typing-indicator"],[1,"typing-dots"],[1,"dot"],[1,"typing-text"],[1,"no-messages"],[1,"no-messages-icon"],[1,"modal-overlay","employees-overlay",3,"click"],[1,"modal-content","employees-modal",3,"click"],[1,"modal-header"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"modal-icon"],["title","Close",1,"btn-close-modal",3,"click"],[1,"modal-body","employees-modal-body"],["class","loading-employees-modal",4,"ngIf"],[1,"search-box"],["width","14","height","14","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["type","text","placeholder","Search team members...",3,"ngModelChange","input","ngModel"],["class","btn-clear-search","title","Clear search",3,"click",4,"ngIf"],["class","employees-modal-list",4,"ngIf"],[1,"modal-actions"],[1,"btn","btn-secondary",3,"click"],["class","btn btn-primary",3,"click",4,"ngIf"],[1,"loading-employees-modal"],["title","Clear search",1,"btn-clear-search",3,"click"],["width","12","height","12","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],[1,"employees-modal-list"],[1,"employees-count-info"],["class","no-employees-modal",4,"ngIf"],["class","employee-modal-item",3,"click",4,"ngFor","ngForOf"],[1,"no-employees-modal"],[1,"employee-modal-item",3,"click"],[1,"employee-avatar"],[1,"employee-info"],[1,"employee-name"],[1,"employee-details"],[1,"employee-role"],["class","employee-department",4,"ngIf"],[1,"employee-status"],[1,"start-chat-action"],["title","Start chat",1,"start-chat-btn"],["width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"],[1,"employee-department"],[1,"btn","btn-primary",3,"click"],[1,"modal-overlay",3,"click"],[1,"modal-content","group-modal",3,"click"],["d","M12 2C9.38 2 7.25 4.13 7.25 6.75c0 2.57 2.01 4.65 4.63 4.74.08-.01.16-.01.22 0h.07a4.738 4.738 0 0 0 4.58-4.74C16.75 4.13 14.62 2 12 2Z"],["d","M17.08 14.1499C14.29 12.2899 9.73996 12.2899 6.92996 14.1499C5.65996 14.9999 4.95996 16.1499 4.95996 17.3799C4.95996 18.6099 5.65996 19.7499 6.91996 20.5899C8.31996 21.5299 10.16 21.9999 12 21.9999C13.84 21.9999 15.68 21.5299 17.08 20.5899C18.34 19.7399 19.04 18.5999 19.04 17.3599C19.03 16.1299 18.34 14.9899 17.08 14.1499Z"],["d","M19 8.75C20.6569 8.75 22 7.40685 22 5.75C22 4.09315 20.6569 2.75 19 2.75C17.3431 2.75 16 4.09315 16 5.75C16 7.40685 17.3431 8.75 19 8.75Z"],["d","M23 18.75C23.8284 18.75 24.5 18.0784 24.5 17.25C24.5 16.4216 23.8284 15.75 23 15.75C22.1716 15.75 21.5 16.4216 21.5 17.25C21.5 18.0784 22.1716 18.75 23 18.75Z"],[1,"modal-body"],[1,"form-group"],["type","text","placeholder","Enter group name",1,"form-control",3,"ngModelChange","ngModel"],["class","error-text",4,"ngIf"],[1,"selection-header"],["class","selected-count",4,"ngIf"],["class","employees-selection",4,"ngIf"],[1,"btn","btn-primary",3,"click","disabled"],[1,"error-text"],[1,"selected-count"],[1,"loading-spinner","small"],[1,"employees-selection"],["type","text","placeholder","Search team members...",3,"ngModelChange","ngModel"],[1,"selection-list"],["class","employee-selection-item",3,"selected","click",4,"ngFor","ngForOf"],[1,"employee-selection-item",3,"click"],[1,"selection-checkbox"],["width","12","height","12","viewBox","0 0 24 24","fill","none","stroke","white","stroke-width","3"],["d","M20 6L9 17l-5-5"]],template:function(e,a){e&1&&_(0,ee,6,7,"div",2)(1,te,1,0,"div",3)(2,Ge,17,14,"div",4),e&2&&(g("ngIf",a.shouldShowChat()),r(),g("ngIf",a.isOpen),r(),g("ngIf",a.shouldShowChat()))},dependencies:[R,j,B,q,$,W,Y,H],styles:['.chat-floating-button[_ngcontent-%COMP%]{position:fixed;z-index:9999}.chat-floating-button.left[_ngcontent-%COMP%]{left:30px;bottom:30px}.chat-floating-button.right[_ngcontent-%COMP%]{right:30px;bottom:30px}.chat-toggle-btn[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,#667eea,#764ba2);border:none;color:#fff;cursor:pointer;box-shadow:0 25px 50px -12px #00000040;display:flex;align-items:center;justify-content:center;position:relative;transition:all .3s cubic-bezier(.4,0,.2,1)}.chat-toggle-btn[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(135deg,#fff3,#fff0);opacity:0;transition:opacity .3s ease}.chat-toggle-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 30px 60px -12px #667eea66}.chat-toggle-btn[_ngcontent-%COMP%]:hover:before{opacity:1}.chat-toggle-btn[_ngcontent-%COMP%]:hover   .chat-icon[_ngcontent-%COMP%]{transform:scale(1.1)}.chat-toggle-btn.active[_ngcontent-%COMP%]{background:#f56565;transform:scale(.95)}.chat-toggle-btn[_ngcontent-%COMP%]   .chat-icon[_ngcontent-%COMP%]{font-size:24px;transition:transform .3s ease;position:relative;z-index:1}.chat-toggle-btn[_ngcontent-%COMP%]   .unread-indicator[_ngcontent-%COMP%]{position:absolute;top:-4px;right:-4px;background:#f56565;color:#fff;border-radius:10px;min-width:20px;height:20px;font-size:11px;font-weight:700;display:flex;align-items:center;justify-content:center;padding:0 6px;border:2px solid white;animation:_ngcontent-%COMP%_pulse 2s infinite;z-index:2}.chat-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0009;-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px);z-index:9998;animation:_ngcontent-%COMP%_fadeIn .3s ease}.chat-panel[_ngcontent-%COMP%]{position:fixed;top:0;width:380px;height:100vh;background:#fff;box-shadow:0 25px 50px -12px #00000040;z-index:9999;display:flex;flex-direction:column;transform:translate(100%);transition:transform .4s cubic-bezier(.4,0,.2,1)}.chat-panel.right-side[_ngcontent-%COMP%]{right:0}.chat-panel.right-side.open[_ngcontent-%COMP%]{transform:translate(0)}.chat-panel.left-side[_ngcontent-%COMP%]{left:0;transform:translate(-100%)}.chat-panel.left-side.open[_ngcontent-%COMP%]{transform:translate(0)}.chat-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);padding:20px;box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d;position:relative;z-index:10}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%], .chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{background:#ffffff26;border:none;color:#fff;width:36px;height:36px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;flex-shrink:0}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]:hover, .chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:hover{background:#ffffff40;transform:scale(1.1)}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#fff}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{flex:1;min-width:0}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .chat-title[_ngcontent-%COMP%]{margin:0;color:#fff;font-size:18px;font-weight:600;display:flex;align-items:center;gap:8px}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .chat-title[_ngcontent-%COMP%]   .title-icon[_ngcontent-%COMP%]{stroke:#fff}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .chat-title[_ngcontent-%COMP%]   .selected-chat-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .chat-title[_ngcontent-%COMP%]   .selected-chat-info[_ngcontent-%COMP%]   .selected-chat-name[_ngcontent-%COMP%]{font-size:16px;font-weight:600;line-height:1.2}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .chat-title[_ngcontent-%COMP%]   .selected-chat-info[_ngcontent-%COMP%]   .user-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:12px;opacity:.9}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .chat-title[_ngcontent-%COMP%]   .selected-chat-info[_ngcontent-%COMP%]   .user-status[_ngcontent-%COMP%]   .status-dot[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:50%;background:#adb5bd}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .chat-title[_ngcontent-%COMP%]   .selected-chat-info[_ngcontent-%COMP%]   .user-status[_ngcontent-%COMP%]   .status-dot.online[_ngcontent-%COMP%]{background:#48bb78;box-shadow:0 0 0 2px #4cc9f04d}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .chat-title[_ngcontent-%COMP%]   .selected-chat-info[_ngcontent-%COMP%]   .user-status[_ngcontent-%COMP%]   .status-text[_ngcontent-%COMP%]{font-weight:500}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .total-unread-badge[_ngcontent-%COMP%]{background:#fff3;color:#fff;padding:4px 10px;border-radius:12px;font-size:12px;font-weight:600;margin-top:4px;display:inline-block;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-toggle-employees[_ngcontent-%COMP%]{background:#ffffff26;border:none;color:#fff;width:36px;height:36px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;flex-shrink:0;position:relative}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-toggle-employees[_ngcontent-%COMP%]:hover{background:#ffffff40;transform:scale(1.1)}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-toggle-employees.active[_ngcontent-%COMP%]{background:#ffffff4d}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-toggle-employees.active[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:4px;left:50%;transform:translate(-50%);width:4px;height:4px;background:#fff;border-radius:50%}.chat-header[_ngcontent-%COMP%]   .chat-header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-toggle-employees[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#fff}.chats-view[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden;background:#fff}.main-chat-container[_ngcontent-%COMP%]{flex:1;display:flex;height:calc(100vh - 70px);overflow:hidden;position:relative;background:#fff}.chats-list-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%}.chats-toolbar[_ngcontent-%COMP%]{padding:16px 20px;background:#fff;border-bottom:1px solid #e9ecef;display:flex;align-items:center;gap:12px}.chats-toolbar[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]{flex:1;position:relative}.chats-toolbar[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:12px;top:50%;transform:translateY(-50%);stroke:#adb5bd}.chats-toolbar[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:100%;padding:10px 12px 10px 36px;border:1px solid #dee2e6;border-radius:12px;font-size:14px;transition:all .3s ease;background:#f8f9fa}.chats-toolbar[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;background:#fff;box-shadow:0 0 0 3px #667eea1a}.chats-toolbar[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]::placeholder{color:#adb5bd}.chats-toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]{display:flex;gap:8px}.chats-toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]   .btn-new-group[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;background:#f8f9fa;border:none;color:#495057;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease}.chats-toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]   .btn-new-group[_ngcontent-%COMP%]:hover{background:#667eea;color:#fff;transform:scale(1.1)}.chats-list-container[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:0}.loading-chats[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px;padding:60px 20px;color:#6c757d}.loading-chats[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{width:32px;height:32px;border:3px solid #e9ecef;border-top:3px solid #667eea;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-chats[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.chat-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:14px 20px;cursor:pointer;transition:all .3s ease;border-bottom:1px solid rgba(233,236,239,.8);position:relative;overflow:hidden}.chat-item[_ngcontent-%COMP%]:hover{background:#667eea0d}.chat-item[_ngcontent-%COMP%]:hover:before{opacity:.1}.chat-item.active[_ngcontent-%COMP%]{background:#667eea1a;border-right:3px solid #667eea}.chat-item.active[_ngcontent-%COMP%]:before{opacity:.1}.chat-item[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(135deg,#667eea,#764ba2);opacity:0;transition:opacity .3s ease}.chat-item[_ngcontent-%COMP%]   .chat-avatar[_ngcontent-%COMP%]{width:44px;height:44px;border-radius:12px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:16px;margin-right:14px;flex-shrink:0;position:relative;z-index:1}.chat-item[_ngcontent-%COMP%]   .chat-avatar.group[_ngcontent-%COMP%]{background:linear-gradient(135deg,#764ba2,#560bad)}.chat-item[_ngcontent-%COMP%]   .chat-avatar.online[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;right:0;width:10px;height:10px;background:#48bb78;border-radius:50%;border:2px solid white}.chat-item[_ngcontent-%COMP%]   .chat-info[_ngcontent-%COMP%]{flex:1;min-width:0;position:relative;z-index:1}.chat-item[_ngcontent-%COMP%]   .chat-info[_ngcontent-%COMP%]   .chat-main-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}.chat-item[_ngcontent-%COMP%]   .chat-info[_ngcontent-%COMP%]   .chat-main-info[_ngcontent-%COMP%]   .chat-name[_ngcontent-%COMP%]{font-weight:600;color:#212529;font-size:14px;line-height:1.2}.chat-item[_ngcontent-%COMP%]   .chat-info[_ngcontent-%COMP%]   .chat-main-info[_ngcontent-%COMP%]   .chat-time[_ngcontent-%COMP%]{font-size:11px;color:#6c757d;font-weight:500}.chat-item[_ngcontent-%COMP%]   .chat-info[_ngcontent-%COMP%]   .chat-preview[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.chat-item[_ngcontent-%COMP%]   .chat-info[_ngcontent-%COMP%]   .chat-preview[_ngcontent-%COMP%]   .last-message[_ngcontent-%COMP%]{font-size:13px;color:#495057;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex:1;line-height:1.3}.chat-item[_ngcontent-%COMP%]   .chat-info[_ngcontent-%COMP%]   .chat-preview[_ngcontent-%COMP%]   .unread-count[_ngcontent-%COMP%]{background:#f56565;color:#fff;border-radius:10px;min-width:18px;height:18px;font-size:10px;font-weight:700;display:flex;align-items:center;justify-content:center;margin-left:8px;flex-shrink:0;padding:0 4px}.no-chats[_ngcontent-%COMP%]{text-align:center;padding:80px 20px;color:#6c757d}.no-chats[_ngcontent-%COMP%]   .no-chats-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:20px;opacity:.3}.no-chats[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;font-weight:500;font-size:15px}.no-chats[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:13px;color:#adb5bd}.messages-view[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden}.messages-container[_ngcontent-%COMP%]{flex:1;padding:20px;overflow-y:auto;display:flex;flex-direction:column;gap:20px;background:linear-gradient(135deg,#f5f7fa,#e4e8f0);position:relative}.loading-messages[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px;padding:60px 20px;color:#6c757d}.loading-messages[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{width:32px;height:32px;border:3px solid rgba(102,126,234,.2);border-top:3px solid #667eea;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-messages[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.message[_ngcontent-%COMP%]{display:flex;animation:_ngcontent-%COMP%_messageAppear .3s ease}.message.sent[_ngcontent-%COMP%]{justify-content:flex-end}.message.sent[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{align-items:flex-end}.message.sent[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-bottom-right-radius:4px}.message.sent[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-footer[_ngcontent-%COMP%]   .message-time[_ngcontent-%COMP%]{color:#fffc}.message.received[_ngcontent-%COMP%]{justify-content:flex-start}.message.received[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{align-items:flex-start}.message.received[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]{background:#fff;color:#212529;border:1px solid #e9ecef;border-bottom-left-radius:4px;box-shadow:0 1px 2px #0000000d}.message.received[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-footer[_ngcontent-%COMP%]   .message-time[_ngcontent-%COMP%]{color:#6c757d}.message-content[_ngcontent-%COMP%]{max-width:75%;display:flex;flex-direction:column;gap:6px}.message-sender[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#495057;margin-left:12px;margin-bottom:-2px}.message-bubble[_ngcontent-%COMP%]{padding:12px 16px;border-radius:18px;position:relative;overflow:hidden}.message-bubble[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(135deg,#ffffff1a,#fff0);opacity:0;transition:opacity .3s ease}.message-bubble[_ngcontent-%COMP%]:hover:before{opacity:1}.message-bubble[_ngcontent-%COMP%]   .message-text[_ngcontent-%COMP%]{margin:0;font-size:14px;line-height:1.5;word-wrap:break-word;position:relative;z-index:1}.message-bubble[_ngcontent-%COMP%]   .message-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;gap:6px;margin-top:6px;position:relative;z-index:1}.message-bubble[_ngcontent-%COMP%]   .message-footer[_ngcontent-%COMP%]   .message-time[_ngcontent-%COMP%]{font-size:10px;font-weight:500;opacity:.9}.message-bubble[_ngcontent-%COMP%]   .message-footer[_ngcontent-%COMP%]   .read-status[_ngcontent-%COMP%]{display:flex;align-items:center}.message-bubble[_ngcontent-%COMP%]   .message-footer[_ngcontent-%COMP%]   .read-status[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#ffffffe6}.typing-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;background:#fff;border-radius:12px;box-shadow:0 1px 2px #0000000d;width:fit-content;max-width:200px;animation:_ngcontent-%COMP%_slideIn .3s ease}.typing-indicator[_ngcontent-%COMP%]   .typing-dots[_ngcontent-%COMP%]{display:flex;gap:4px}.typing-indicator[_ngcontent-%COMP%]   .typing-dots[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]{width:6px;height:6px;border-radius:50%;background:#667eea;animation:_ngcontent-%COMP%_typing 1.4s infinite ease-in-out}.typing-indicator[_ngcontent-%COMP%]   .typing-dots[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}.typing-indicator[_ngcontent-%COMP%]   .typing-dots[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]:nth-child(3){animation-delay:.4s}.typing-indicator[_ngcontent-%COMP%]   .typing-text[_ngcontent-%COMP%]{font-size:12px;color:#495057;font-weight:500}.no-messages[_ngcontent-%COMP%]{text-align:center;padding:80px 20px;color:#6c757d}.no-messages[_ngcontent-%COMP%]   .no-messages-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:20px;opacity:.3}.no-messages[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;font-weight:500;font-size:15px}.no-messages[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:13px;color:#adb5bd}.message-input-container[_ngcontent-%COMP%]{padding:20px;background:#fff;border-top:1px solid #e9ecef;box-shadow:0 1px 2px #0000000d}.message-input-wrapper[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:12px;background:#f8f9fa;border:1px solid #dee2e6;border-radius:16px;padding:10px 10px 10px 16px;transition:all .3s ease;position:relative}.message-input-wrapper[_ngcontent-%COMP%]:focus-within{border-color:#667eea;background:#fff;box-shadow:0 0 0 3px #667eea1a}.message-input-wrapper[_ngcontent-%COMP%]   .btn-attach[_ngcontent-%COMP%]{background:none;border:none;color:#6c757d;cursor:pointer;width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all .3s ease;flex-shrink:0}.message-input-wrapper[_ngcontent-%COMP%]   .btn-attach[_ngcontent-%COMP%]:hover{background:#e9ecef;color:#667eea}.message-input-wrapper[_ngcontent-%COMP%]   .btn-attach[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:currentColor}.message-input[_ngcontent-%COMP%]{flex:1;border:none;background:transparent;resize:none;font-size:14px;line-height:1.5;max-height:120px;min-height:20px;font-family:inherit}.message-input[_ngcontent-%COMP%]:focus{outline:none}.message-input[_ngcontent-%COMP%]::placeholder{color:#adb5bd}.btn-send[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,#667eea,#764ba2);border:none;color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;flex-shrink:0;position:relative;overflow:hidden}.btn-send[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(135deg,#fff3,#fff0);opacity:0;transition:opacity .3s ease}.btn-send[_ngcontent-%COMP%]:hover:not(:disabled){transform:scale(1.1)}.btn-send[_ngcontent-%COMP%]:hover:not(:disabled):before{opacity:1}.btn-send[_ngcontent-%COMP%]:disabled{background:#ced4da;cursor:not-allowed;transform:none}.btn-send[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#fff;position:relative;z-index:1}.modal-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#000c;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);display:flex;align-items:center;justify-content:center;z-index:10000;animation:_ngcontent-%COMP%_fadeIn .3s ease}.modal-overlay.employees-overlay[_ngcontent-%COMP%]{z-index:10001}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:16px;width:90%;max-width:450px;max-height:80vh;overflow:hidden;box-shadow:0 25px 50px -12px #00000040;animation:_ngcontent-%COMP%_slideUp .3s ease}.modal-content.employees-modal[_ngcontent-%COMP%]{max-width:500px;max-height:85vh}.modal-content.group-modal[_ngcontent-%COMP%]{max-width:450px}.modal-header[_ngcontent-%COMP%]{padding:20px 24px;border-bottom:1px solid #e9ecef;display:flex;justify-content:space-between;align-items:center;background:linear-gradient(135deg,#f8f9fa,#fff)}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#212529;display:flex;align-items:center;gap:10px}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   .modal-icon[_ngcontent-%COMP%]{stroke:#667eea}.modal-header[_ngcontent-%COMP%]   .btn-close-modal[_ngcontent-%COMP%]{background:#f8f9fa;border:none;width:32px;height:32px;border-radius:50%;color:#495057;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease}.modal-header[_ngcontent-%COMP%]   .btn-close-modal[_ngcontent-%COMP%]:hover{background:#e9ecef;color:#212529}.modal-body[_ngcontent-%COMP%]{padding:24px;max-height:400px;overflow-y:auto}.modal-body.employees-modal-body[_ngcontent-%COMP%]{max-height:500px;padding:16px 24px;display:flex;flex-direction:column;gap:16px}.search-box[_ngcontent-%COMP%]{position:relative}.search-box[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:absolute;left:14px;top:50%;transform:translateY(-50%);stroke:#adb5bd}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px 42px;border:1px solid #dee2e6;border-radius:12px;font-size:14px;background:#f8f9fa;color:#212529;transition:all .3s ease}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;background:#fff;box-shadow:0 0 0 3px #667eea1a}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#adb5bd}.search-box[_ngcontent-%COMP%]   .btn-clear-search[_ngcontent-%COMP%]{position:absolute;right:14px;top:50%;transform:translateY(-50%);background:transparent;border:none;color:#adb5bd;cursor:pointer;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all .3s ease}.search-box[_ngcontent-%COMP%]   .btn-clear-search[_ngcontent-%COMP%]:hover{background:#e9ecef;color:#495057}.employees-count-info[_ngcontent-%COMP%]{font-size:12px;color:#6c757d;font-weight:500;padding:4px 0;border-bottom:1px solid #e9ecef;margin-bottom:8px}.employees-modal-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;display:flex;flex-direction:column;gap:10px;padding-right:4px}.employees-modal-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.employees-modal-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ced4da;border-radius:3px}.employee-modal-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:14px 16px;background:#fff;border:1px solid #e9ecef;border-radius:12px;cursor:pointer;transition:all .2s ease;position:relative;overflow:hidden}.employee-modal-item[_ngcontent-%COMP%]:hover{transform:translateY(-2px);border-color:#667eea;box-shadow:0 1px 2px #0000000d}.employee-modal-item[_ngcontent-%COMP%]:hover   .employee-avatar[_ngcontent-%COMP%]{transform:scale(1.05)}.employee-modal-item[_ngcontent-%COMP%]:hover   .start-chat-btn[_ngcontent-%COMP%]{opacity:1;transform:translate(0)}.employee-modal-item[_ngcontent-%COMP%]:active{transform:translateY(0)}.employee-modal-item[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(135deg,#667eea0d,#667eea00);opacity:0;transition:opacity .3s ease}.employee-modal-item[_ngcontent-%COMP%]:hover:before{opacity:1}.employee-avatar[_ngcontent-%COMP%]{width:46px;height:46px;border-radius:12px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:18px;margin-right:16px;position:relative;transition:transform .3s ease;flex-shrink:0}.employee-avatar.online[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-2px;right:-2px;width:12px;height:12px;background:#48bb78;border-radius:50%;border:2px solid white}.employee-info[_ngcontent-%COMP%]{flex:1;min-width:0;display:flex;gap:4px}.employee-info[_ngcontent-%COMP%]   .employee-name[_ngcontent-%COMP%]{font-weight:600;color:#212529;font-size:15px;line-height:1.3}.employee-info[_ngcontent-%COMP%]   .employee-details[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:13px;color:#6c757d}.employee-info[_ngcontent-%COMP%]   .employee-details[_ngcontent-%COMP%]   .employee-role[_ngcontent-%COMP%]{font-weight:500;background:#f8f9fa;padding:3px 10px;border-radius:6px;font-size:12px}.employee-info[_ngcontent-%COMP%]   .employee-details[_ngcontent-%COMP%]   .employee-department[_ngcontent-%COMP%]{font-style:italic}.employee-info[_ngcontent-%COMP%]   .employee-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.employee-info[_ngcontent-%COMP%]   .employee-status[_ngcontent-%COMP%]   .status-dot[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:50%;background:#ced4da}.employee-info[_ngcontent-%COMP%]   .employee-status[_ngcontent-%COMP%]   .status-dot.online[_ngcontent-%COMP%]{background:#48bb78;box-shadow:0 0 0 2px #48bb7833}.employee-info[_ngcontent-%COMP%]   .employee-status[_ngcontent-%COMP%]   .status-text[_ngcontent-%COMP%]{font-size:12px;font-weight:500;color:#6c757d}.start-chat-action[_ngcontent-%COMP%]   .start-chat-btn[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:#f8f9fa;border:1px solid #dee2e6;color:#495057;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;opacity:0;transform:translate(10px)}.start-chat-action[_ngcontent-%COMP%]   .start-chat-btn[_ngcontent-%COMP%]:hover{background:#667eea;color:#fff;border-color:#667eea;transform:scale(1.1) translate(0)}.start-chat-action[_ngcontent-%COMP%]   .start-chat-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:currentColor;stroke-width:2}.form-group[_ngcontent-%COMP%]{margin-bottom:24px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:600;color:#212529;font-size:14px}.form-group[_ngcontent-%COMP%]   .selection-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.form-group[_ngcontent-%COMP%]   .selection-header[_ngcontent-%COMP%]   .selected-count[_ngcontent-%COMP%]{font-size:12px;color:#667eea;font-weight:600;background:#667eea1a;padding:4px 10px;border-radius:12px}.form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{width:100%;padding:12px 16px;border:1px solid #dee2e6;border-radius:12px;font-size:14px;transition:all .3s ease;background:#f8f9fa}.form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;background:#fff;box-shadow:0 0 0 3px #667eea1a}.employees-selection[_ngcontent-%COMP%]{border:1px solid #dee2e6;border-radius:12px;overflow:hidden}.selection-list[_ngcontent-%COMP%]{max-height:200px;overflow-y:auto}.employee-selection-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px 16px;cursor:pointer;transition:all .3s ease;border-bottom:1px solid #e9ecef;position:relative}.employee-selection-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.employee-selection-item[_ngcontent-%COMP%]:hover{background:#f8f9fa}.employee-selection-item[_ngcontent-%COMP%]:hover   .employee-avatar[_ngcontent-%COMP%]{transform:scale(1.05)}.employee-selection-item.selected[_ngcontent-%COMP%]{background:#667eea0d;border-left:3px solid #667eea}.employee-selection-item.selected[_ngcontent-%COMP%]   .selection-checkbox[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border-color:#667eea}.employee-selection-item[_ngcontent-%COMP%]   .employee-avatar[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:8px;font-size:15px;margin-right:12px}.employee-selection-item[_ngcontent-%COMP%]   .employee-avatar.online[_ngcontent-%COMP%]:after{width:8px;height:8px;border-width:1px}.employee-selection-item[_ngcontent-%COMP%]   .employee-info[_ngcontent-%COMP%]{flex:1;min-width:0}.employee-selection-item[_ngcontent-%COMP%]   .employee-info[_ngcontent-%COMP%]   .employee-name[_ngcontent-%COMP%]{font-size:14px}.employee-selection-item[_ngcontent-%COMP%]   .employee-info[_ngcontent-%COMP%]   .employee-details[_ngcontent-%COMP%]{font-size:12px}.employee-selection-item[_ngcontent-%COMP%]   .employee-info[_ngcontent-%COMP%]   .employee-details[_ngcontent-%COMP%]   .employee-role[_ngcontent-%COMP%]{padding:2px 8px;border-radius:4px;font-size:11px}.employee-selection-item[_ngcontent-%COMP%]   .selection-checkbox[_ngcontent-%COMP%]{width:20px;height:20px;border:2px solid #ced4da;border-radius:5px;display:flex;align-items:center;justify-content:center;transition:all .3s ease;flex-shrink:0}.employee-selection-item[_ngcontent-%COMP%]   .selection-checkbox.selected[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{opacity:1}.employee-selection-item[_ngcontent-%COMP%]   .selection-checkbox[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{opacity:0;transition:opacity .3s ease}.no-employees-modal[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6c757d}.no-employees-modal[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 4px;font-weight:500;font-size:14px}.no-employees-modal[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px;color:#adb5bd}.loading-employees-modal[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;color:#6c757d}.loading-employees-modal[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{width:24px;height:24px;border:3px solid rgba(102,126,234,.2);border-top:3px solid #667eea;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-employees-modal[_ngcontent-%COMP%]   .loading-spinner.small[_ngcontent-%COMP%]{width:20px;height:20px;border-width:2px}.loading-employees-modal[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;margin-top:12px}.modal-actions[_ngcontent-%COMP%]{padding:20px 24px;border-top:1px solid #e9ecef;display:flex;gap:12px;justify-content:flex-end;background:#f8f9fa}.modal-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:10px 24px;border:none;border-radius:12px;font-weight:600;font-size:14px;cursor:pointer;transition:all .3s ease;min-width:100px}.modal-actions[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]{background:#fff;color:#495057;border:1px solid #dee2e6}.modal-actions[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]:hover{background:#f8f9fa;border-color:#ced4da}.modal-actions[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.modal-actions[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d}.modal-actions[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]:disabled{background:#ced4da;cursor:not-allowed;transform:none;box-shadow:none}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(30px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1);box-shadow:0 0 #f56565b3}50%{transform:scale(1.05)}70%{transform:scale(1);box-shadow:0 0 0 10px #f5656500}to{transform:scale(1);box-shadow:0 0 #f5656500}}@keyframes _ngcontent-%COMP%_typing{0%,60%,to{transform:translateY(0);opacity:.4}30%{transform:translateY(-4px);opacity:1}}@keyframes _ngcontent-%COMP%_messageAppear{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.chats-list-container[_ngcontent-%COMP%]::-webkit-scrollbar, .messages-container[_ngcontent-%COMP%]::-webkit-scrollbar, .employees-modal-list[_ngcontent-%COMP%]::-webkit-scrollbar, .selection-list[_ngcontent-%COMP%]::-webkit-scrollbar, .modal-body[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:8px}.chats-list-container[_ngcontent-%COMP%]::-webkit-scrollbar-track, .messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-track, .employees-modal-list[_ngcontent-%COMP%]::-webkit-scrollbar-track, .selection-list[_ngcontent-%COMP%]::-webkit-scrollbar-track, .modal-body[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent;border-radius:4px}.chats-list-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .employees-modal-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .selection-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .modal-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ced4da;border-radius:4px;border:2px solid transparent;background-clip:padding-box}.chats-list-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .employees-modal-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .selection-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .modal-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#adb5bd}.chats-list-container[_ngcontent-%COMP%]::-webkit-scrollbar-corner, .messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-corner, .employees-modal-list[_ngcontent-%COMP%]::-webkit-scrollbar-corner, .selection-list[_ngcontent-%COMP%]::-webkit-scrollbar-corner, .modal-body[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}@media (max-width: 768px){.chat-panel[_ngcontent-%COMP%]{width:100%}.chat-panel.right-side[_ngcontent-%COMP%]{transform:translate(100%)}.chat-panel.right-side.open[_ngcontent-%COMP%]{transform:translate(0)}.chat-panel.left-side[_ngcontent-%COMP%]{transform:translate(-100%)}.chat-panel.left-side.open[_ngcontent-%COMP%]{transform:translate(0)}.chat-floating-button.left[_ngcontent-%COMP%], .chat-floating-button.right[_ngcontent-%COMP%]{bottom:20px}.chat-floating-button.left[_ngcontent-%COMP%]{left:20px}.chat-floating-button.right[_ngcontent-%COMP%]{right:20px}.chat-toggle-btn[_ngcontent-%COMP%]{width:52px;height:52px}.modal-content[_ngcontent-%COMP%]{width:95%;margin:20px}.modal-content.employees-modal[_ngcontent-%COMP%], .modal-content.group-modal[_ngcontent-%COMP%]{width:95%;max-height:90vh}.employee-modal-item[_ngcontent-%COMP%]{padding:12px 14px}.employee-avatar[_ngcontent-%COMP%]{width:42px;height:42px;font-size:16px}.employee-info[_ngcontent-%COMP%]   .employee-name[_ngcontent-%COMP%]{font-size:14px}}@media (prefers-color-scheme: dark){.chat-panel[_ngcontent-%COMP%]{background:#212529;color:#f8f9fa}.chats-view[_ngcontent-%COMP%], .main-chat-container[_ngcontent-%COMP%], .chats-list-section[_ngcontent-%COMP%]{background:#212529}.chats-toolbar[_ngcontent-%COMP%]{background:#343a40;border-bottom-color:#495057}.chats-toolbar[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{background:#495057;border-color:#6c757d;color:#f8f9fa}.chats-toolbar[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{border-color:#667eea;background:#343a40}.chats-toolbar[_ngcontent-%COMP%]   .btn-new-group[_ngcontent-%COMP%]{background:#495057;color:#dee2e6}.chats-toolbar[_ngcontent-%COMP%]   .btn-new-group[_ngcontent-%COMP%]:hover{background:#667eea;color:#fff}.chat-item[_ngcontent-%COMP%]{border-bottom-color:#495057}.chat-item[_ngcontent-%COMP%]:hover{background:#667eea1a}.chat-item.active[_ngcontent-%COMP%]{background:#667eea26}.chat-item[_ngcontent-%COMP%]   .chat-info[_ngcontent-%COMP%]   .chat-name[_ngcontent-%COMP%]{color:#f8f9fa}.chat-item[_ngcontent-%COMP%]   .chat-info[_ngcontent-%COMP%]   .chat-preview[_ngcontent-%COMP%]   .last-message[_ngcontent-%COMP%]{color:#ced4da}.messages-container[_ngcontent-%COMP%]{background:linear-gradient(135deg,#343a40,#212529)}.message.received[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]{background:#343a40;color:#f8f9fa;border-color:#495057}.message-input-container[_ngcontent-%COMP%]{background:#343a40;border-top-color:#495057}.message-input-wrapper[_ngcontent-%COMP%]{background:#495057;border-color:#6c757d}.message-input-wrapper[_ngcontent-%COMP%]:focus-within{border-color:#667eea;background:#343a40}.message-input-wrapper[_ngcontent-%COMP%]   .btn-attach[_ngcontent-%COMP%]{color:#ced4da}.message-input-wrapper[_ngcontent-%COMP%]   .btn-attach[_ngcontent-%COMP%]:hover{background:#6c757d;color:#667eea}.message-input[_ngcontent-%COMP%]{color:#f8f9fa}.modal-content[_ngcontent-%COMP%]{background:#343a40;color:#f8f9fa}.modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#495057,#343a40);border-bottom-color:#495057}.modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#f8f9fa}.modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .btn-close-modal[_ngcontent-%COMP%]{background:#495057;color:#dee2e6}.modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .btn-close-modal[_ngcontent-%COMP%]:hover{background:#6c757d;color:#f8f9fa}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:#495057;border-color:#6c757d;color:#f8f9fa}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:#343a40;border-color:#667eea}.search-box[_ngcontent-%COMP%]   .btn-clear-search[_ngcontent-%COMP%]{color:#ced4da}.search-box[_ngcontent-%COMP%]   .btn-clear-search[_ngcontent-%COMP%]:hover{background:#6c757d;color:#f8f9fa}.employee-modal-item[_ngcontent-%COMP%]{background:#495057;border-color:#6c757d}.employee-modal-item[_ngcontent-%COMP%]:hover{border-color:#667eea}.employee-modal-item[_ngcontent-%COMP%]   .employee-info[_ngcontent-%COMP%]   .employee-name[_ngcontent-%COMP%]{color:#f8f9fa}.employee-modal-item[_ngcontent-%COMP%]   .employee-info[_ngcontent-%COMP%]   .employee-details[_ngcontent-%COMP%]{color:#ced4da}.employee-modal-item[_ngcontent-%COMP%]   .employee-info[_ngcontent-%COMP%]   .employee-details[_ngcontent-%COMP%]   .employee-role[_ngcontent-%COMP%]{background:#6c757d;color:#dee2e6}.employee-modal-item[_ngcontent-%COMP%]   .employee-info[_ngcontent-%COMP%]   .employee-status[_ngcontent-%COMP%]   .status-text[_ngcontent-%COMP%]{color:#ced4da}.employee-modal-item[_ngcontent-%COMP%]   .start-chat-action[_ngcontent-%COMP%]   .start-chat-btn[_ngcontent-%COMP%]{background:#6c757d;border-color:#adb5bd;color:#dee2e6}.employee-modal-item[_ngcontent-%COMP%]   .start-chat-action[_ngcontent-%COMP%]   .start-chat-btn[_ngcontent-%COMP%]:hover{background:#667eea;color:#fff;border-color:#667eea}.form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background:#495057;border-color:#6c757d;color:#f8f9fa}.form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{background:#343a40;border-color:#667eea}.employee-selection-item[_ngcontent-%COMP%]{border-bottom-color:#495057}.employee-selection-item[_ngcontent-%COMP%]:hover{background:#495057}.employee-selection-item.selected[_ngcontent-%COMP%]{background:#667eea1a}.modal-actions[_ngcontent-%COMP%]{background:#343a40;border-top-color:#495057}.modal-actions[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]{background:#495057;color:#dee2e6;border-color:#6c757d}.modal-actions[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]:hover{background:#6c757d;border-color:#adb5bd}}']})};export{Z as a};
