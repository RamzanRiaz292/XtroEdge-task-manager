<div class="dashboard-container">
  <!-- Header -->
  <div class="header-bar">
    <div class="header-content">
      <h1>Dashboard</h1>
      <div class="user-info">
        <div class="user-details">
          <span class="welcome-text">Welcome back, {{ user?.name }}!</span>
          <span class="user-role">({{ user?.role | titlecase }})</span>
        </div>
        <button (click)="logout()" class="btn btn-logout">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
            <polyline points="16 17 21 12 16 7" />
            <line x1="21" y1="12" x2="9" y2="12" />
          </svg>
          Logout</button>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="spinner-large"></div>
    <p>Loading your dashboard...</p>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!isLoading" class="dashboard-content">

    <!-- Quick Stats -->
    <div class="stats-grid">
      <div class="stat-card total-tasks">
        <div class="stat-icon">ğŸ“Š</div>
        <div class="stat-info">
          <h3>Total Tasks</h3>
          <span class="stat-number">{{ stats.totalTasks }}</span>
        </div>
      </div>

      <div class="stat-card completed-tasks">
        <div class="stat-icon">âœ…</div>
        <div class="stat-info">
          <h3>Completed</h3>
          <span class="stat-number">{{ stats.completedTasks }}</span>
        </div>
      </div>

      <div class="stat-card pending-tasks">
        <div class="stat-icon">â³</div>
        <div class="stat-info">
          <h3>In Progress</h3>
          <span class="stat-number">{{ stats.inProgressTasks }}</span>
        </div>
      </div>

      <!-- NEW: Pending Tasks Stat Card -->
      <div class="stat-card new-pending-tasks">
        <div class="stat-icon">ğŸ“</div>
        <div class="stat-info">
          <h3>Pending</h3>
          <span class="stat-number">{{ stats.pendingTasks }}</span>
        </div>
      </div>

      <div class="stat-card overdue-tasks">
        <div class="stat-icon">ğŸš¨</div>
        <div class="stat-info">
          <h3>Overdue</h3>
          <span class="stat-number">{{ stats.overdueTasks }}</span>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <!-- <div class="actions-section">
      <h2>Quick Actions</h2>
      <div class="actions-grid">
        <button (click)="navigateTo('/tasks')" class="action-card">
          <div class="action-icon">ğŸ“‹</div>
          <h4>View All Tasks</h4>
          <p>Manage your assigned tasks</p>
        </button>

        <button (click)="navigateTo('/calendar')" class="action-card">
          <div class="action-icon">ğŸ“…</div>
          <h4>Calendar View</h4>
          <p>See tasks on calendar</p>
        </button>

        <button *ngIf="user?.role === 'manager'" (click)="navigateTo('/manager-tasks')" class="action-card">
          <div class="action-icon">ğŸ‘¥</div>
          <h4>Manage Tasks</h4>
          <p>Assign tasks to employees</p>
        </button>

        <button (click)="navigateTo('/employee-analytics')" class="action-card">
          <div class="action-icon">âš¡</div>
          <h4>Employee Analytics</h4>
          <p>Start working on tasks</p>
        </button>
      </div>
    </div> -->

    <!-- Today's Tasks & Pending Tasks Details -->
    <div class="tasks-details-section">
      <h2>Today's Tasks & Pending Work</h2>
      <div class="tasks-details-grid">

        <!-- Today's Tasks -->
        <div class="tasks-category-card">
          <div class="category-header">
            <div class="category-icon">ğŸ“…</div>
            <h3>Today's Tasks</h3>
            <span class="task-count">{{ getTodaysTasksCount() }}</span>
          </div>

          <div *ngIf="getTodaysTasks().length === 0" class="empty-category">
            <p>No tasks due today</p>
          </div>

          <div *ngIf="getTodaysTasks().length > 0" class="category-tasks">
            <div *ngFor="let task of getTodaysTasks()" class="detail-task-item">
              <div class="task-info">
                <h4 class="task-title">{{ task.title }}</h4>
                <div class="task-meta">
                  <span class="priority-badge" [ngClass]="getPriorityClass(task.priority)">
                    {{ task.priority }}
                  </span>
                  <span class="status-badge" [ngClass]="getStatusClass(task.status)">
                    {{ task.status.replace('_', ' ') }}
                  </span>
                </div>
              </div>
              <div class="task-time">
                <span class="time-remaining" [ngClass]="{'overdue': task.is_overdue}">
                  {{ formatTimeRemaining(task.time_remaining || 0) }}
                </span>
              </div>
            </div>
          </div>
          <div *ngIf="getTodaysTasksCount() > 3" class="view-all-link">
            <button (click)="viewTodayTasks()" class="btn-text">View All Today's Tasks â†’</button>
          </div>
        </div>

        <!-- Pending Tasks -->
        <div class="tasks-category-card">
          <div class="category-header">
            <div class="category-icon">â³</div>
            <h3>Pending Tasks</h3>
            <span class="task-count">{{ getPendingTasksCount() }}</span>
          </div>

          <div *ngIf="getPendingTasks().length === 0" class="empty-category">
            <p>No pending tasks</p>
          </div>

          <div *ngIf="getPendingTasks().length > 0" class="category-tasks">
            <div *ngFor="let task of getPendingTasks()" class="detail-task-item">
              <div class="task-info">
                <h4 class="task-title">{{ task.title }}</h4>
                <div class="task-meta">
                  <span class="priority-badge" [ngClass]="getPriorityClass(task.priority)">
                    {{ task.priority }}
                  </span>
                  <span class="due-date">
                    Due: {{ task.due_date | date:'MMM dd' }}
                  </span>
                </div>
              </div>
              <div class="task-assignee">
                {{ task.assigned_to_name }}
              </div>
            </div>
          </div>
          <div *ngIf="getPendingTasksCount() > 3" class="view-all-link">
            <button (click)="viewPendingTasks()" class="btn-text">View All Pending Tasks â†’</button>
          </div>
        </div>

        <!-- Overdue Tasks -->
        <div class="tasks-category-card">
          <div class="category-header">
            <div class="category-icon">ğŸš¨</div>
            <h3>Overdue Tasks</h3>
            <span class="task-count overdue-count">{{ getOverdueTasksCount() }}</span>
          </div>

          <div *ngIf="getOverdueTasks().length === 0" class="empty-category">
            <p>No overdue tasks ğŸ‰</p>
          </div>

          <div *ngIf="getOverdueTasks().length > 0" class="category-tasks">
            <div *ngFor="let task of getOverdueTasks()" class="detail-task-item overdue-task">
              <div class="task-info">
                <h4 class="task-title">{{ task.title }}</h4>
                <div class="task-meta">
                  <span class="priority-badge priority-high">Urgent</span>
                  <span class="overdue-days">
                    {{ getOverdueDays(task) }} days late
                  </span>
                </div>
              </div>
              <button (click)="startTask(task.id)" class="btn btn-small btn-danger">
                Start
              </button>
            </div>
          </div>
          <div *ngIf="getOverdueTasksCount() > 3" class="view-all-link">
            <button (click)="viewOverdueTasks()" class="btn-text">View All Overdue Tasks â†’</button>
          </div>
        </div>

        <!-- In Progress Tasks -->
        <div class="tasks-category-card">
          <div class="category-header">
            <div class="category-icon">âš¡</div>
            <h3>In Progress</h3>
            <span class="task-count">{{ getInProgressTasksCount() }}</span>
          </div>

          <div *ngIf="getInProgressTasks().length === 0" class="empty-category">
            <p>No tasks in progress</p>
          </div>

          <div *ngIf="getInProgressTasks().length > 0" class="category-tasks">
            <div *ngFor="let task of getInProgressTasks()" class="detail-task-item">
              <div class="task-info">
                <h4 class="task-title">{{ task.title }}</h4>
                <div class="task-meta">
                  <span class="progress-percent">
                    {{ getTaskProgress(task) }}% complete
                  </span>
                </div>
              </div>
              <div class="progress-bar small">
                <div class="progress-fill" [style.width.%]="getTaskProgress(task)"></div>
              </div>
            </div>
          </div>
          <div *ngIf="getInProgressTasksCount() > 3" class="view-all-link">
            <button (click)="viewInProgressTasks()" class="btn-text">View All In Progress â†’</button>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>